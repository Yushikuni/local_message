{"version":3,"sources":["../src/confirm.js"],"names":["define","$","ModalFactory","String","ModalEvents","Ajax","Notification","trigger","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","classString","classList","messageid","substr","lastIndexOf","params","setSaveButtonText","large","done","getRoot","save","e","preventDefault","request","Y","one","footer","setContent","spinner","M","util","add_spinner","Show","log","data","window","location","reload","addNotification","message","fail","exception"],"mappings":"AAAAA,OAAM,yBAAC,CAAC,QAAD,CAAW,oBAAX,CAAiC,UAAjC,CAA4C,mBAA5C,CAAiE,WAAjE,CAA8E,mBAA9E,CAAD,CAAqG,SAASC,CAAT,CAAYC,CAAZ,CAA0BC,CAA1B,CAAkCC,CAAlC,CAA+CC,CAA/C,CAAqDC,CAArD,CAAkE,CACzK,GAAIC,CAAAA,CAAO,CAAGN,CAAC,CAAC,8BAAD,CAAf,CACAC,CAAY,CAACM,MAAb,CAAoB,CAChBC,IAAI,CAAGP,CAAY,CAACQ,KAAb,CAAmBC,WADV,CAEhBC,KAAK,CAAET,CAAM,CAACU,UAAP,CAAkB,SAAlB,CAA4B,eAA5B,CAFS,CAGhBC,IAAI,CAAEX,CAAM,CAACU,UAAP,CAAkB,iBAAlB,CAAoC,eAApC,CAHU,CAIhBE,eAAe,CAAE,yBAASC,CAAT,CAAyBC,CAAzB,CAA+B,CAC5CD,CAAc,CAAGf,CAAC,CAACe,CAAD,CAAlB,CAD4C,GAGxCE,CAAAA,CAAW,CAAGF,CAAc,CAAC,CAAD,CAAd,CAAkBG,SAAlB,CAA4B,CAA5B,CAH0B,CAIxCC,CAAS,CAAGF,CAAW,CAACG,MAAZ,CAAmBH,CAAW,CAACI,WAAZ,CAAwB,iBAAxB,IAAnB,CAJ4B,CAM5CL,CAAK,CAACM,MAAN,CAAe,CAAC,UAAYH,CAAb,CAAf,CACAH,CAAK,CAACO,iBAAN,CAAwBrB,CAAM,CAACU,UAAP,CAAkB,SAAlB,CAA4B,eAA5B,CAAxB,CACH,CAZe,CAahBY,KAAK,GAbW,CAApB,CAcGlB,CAdH,EAeCmB,IAfD,CAeM,SAAST,CAAT,CAAe,CAEjBA,CAAK,CAACU,OAAN,GAAgBD,IAAhB,CAAqBtB,CAAW,CAACwB,IAAjC,CAAuC,SAASC,CAAT,CAAW,CAC9CA,CAAC,CAACC,cAAF,GAEA,GAAIC,CAAAA,CAAO,CAAGC,CAAC,CAAEC,GAAH,CAAO,eAAP,CAAd,CACAC,MAAM,CAACC,UAAP,CAAkB,yBAAlB,EACA,GAAIC,CAAAA,CAAO,CAAGC,CAAC,CAACC,IAAF,CAAOC,WAAP,CAAmBP,CAAnB,CAAsBE,MAAtB,CAAd,CACAE,CAAO,CAACI,IAAR,GAEAR,CAAC,CAACS,GAAF,CAAMxB,CAAK,CAACM,MAAZ,EAGAlB,CAAI,CAACc,SAAL,CAAe,CAACY,CAAD,CAAf,EAA0B,CAA1B,EAA6BL,IAA7B,CAAkC,SAASgB,CAAT,CAAc,CAC5C,GAAG,KAAAA,CAAH,CAAiB,CAEbC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACAb,CAAC,CAACS,GAAF,CAAM,wBAAN,CACH,CAJD,IAIK,CACDnC,CAAY,CAACwC,eAAb,CAA6B,CACzBC,OAAO,CAAE5C,CAAM,CAACU,UAAP,CAAkB,aAAlB,CAAgC,eAAhC,CADgB,CAEzBJ,IAAI,CAAC,OAFoB,CAA7B,CAIH,CACJ,CAXD,EAWGuC,IAXH,CAWQ1C,CAAY,CAAC2C,SAXrB,CAYH,CAvBD,CAwBH,CAzCD,CA0CH,CA5CK,CAAN","sourcesContent":["define(['jquery', 'core/modal_factory', 'core/str','core/modal_events', 'core/ajax', 'core/notification'], function($, ModalFactory, String, ModalEvents, Ajax, Notification){\r\n    var trigger = $('.local_message_delete_button');\r\n    ModalFactory.create({\r\n        type:  ModalFactory.types.SAVE_CANCEL,\r\n        title: String.get_string('deltmsg','local_message'),\r\n        body: String.get_string('deltmsg_confirm','local_message'),\r\n        preShowCallback: function(triggerElement, modal){\r\n            triggerElement = $(triggerElement);\r\n\r\n            let classString = triggerElement[0].classList[0];\r\n            let messageid = classString.substr(classString.lastIndexOf('local_messageid') + 'local_messageid'.length);\r\n\r\n            modal.params = {'messageid':messageid};\r\n            modal.setSaveButtonText(String.get_string('deltmsg','local_message'));\r\n        },\r\n        large:true,\r\n    }, trigger)\r\n    .done(function(modal){\r\n        // Do what you want with your new modal.\r\n        modal.getRoot().done(ModalEvents.save, function(e){\r\n            e.preventDefault();\r\n\r\n            let request = Y .one('.modal-footer');\r\n            footer.setContent('Delete in processâ€¦');\r\n            let spinner = M.util.add_spinner(Y, footer);\r\n            spinner.Show();\r\n\r\n            Y.log(modal.params);\r\n\r\n            \r\n            Ajax.classList([request])[0].done(function(data){\r\n                if(data === true){\r\n                    //redirect to manage page\r\n                    window.location.reload();\r\n                    Y.log('massage was deleted...');\r\n                }else{\r\n                    Notification.addNotification({\r\n                        message: String.get_string('dltmsg_fail','local_message'),\r\n                        type:'error',\r\n                    });\r\n                }\r\n            }).fail(Notification.exception);\r\n        });\r\n    });\r\n});"],"file":"confirm.min.js"}